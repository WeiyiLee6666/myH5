<script type="text/javascript">
    //百度地图获取坐标
    function getAddr() {
        var geolocation = new BMap.Geolocation();
        var pt;
        geolocation.getCurrentPosition(function (r) {
            if (this.getStatus() == BMAP_STATUS_SUCCESS) {
                //setCookie("localX", r.point.lng);
                //setCookie("localY", r.point.lat);
                alert(r.point.lng + " ， " + r.point.lat);
                pt = r;
                showPosition(pt);
                //传参数给地图按钮
                //document.getElementById("alinkMap").href += "&x="+r.point.lng+"&y="+r.point.lat;
                //document.getElementById("alinkMap").style.display="block";
            }
        });
    }
    //百度地图WebAPI 坐标转地址
    function showPosition(r) {
        // ak = appkey 访问次数流量有限制
        var url = 'http://api.map.baidu.com/geocoder/v2/?ak=7b788c5ea45cc4b3ac6331a4b0643d5b&callback=?&location=' + r.point.lat + ',' + r.point.lng + '&output=json&pois=1';
        $.getJSON(url, function (res) {
            $("#msg").html(url);
            alert(res.result.addressComponent.city);
        });
    }
    //百度地图JS API 坐标转地址，没有加载地图时获取不到rs,总是null
    function getLocation(myGeo,pt,rs) {
        // 根据坐标得到地址描述 
        myGeo.getLocation(pt, function (rs) {
            if (rs) {
                var addComp = rs.addressComponents;
                window.clearInterval(interval);
                alert(addComp);
            }
            return rs;
        });
    }
     
    //微信获取的是Google坐标， 转换为腾讯地图地址偏差到中原区了
    //lat = 34.7466;
    //long = 113.625368;
    //var point = new qq.maps.LatLng(lat, long);
    ////地址和经纬度之间进行转换服务
    //geocoder = new qq.maps.Geocoder();
    //geocoder.getAddress(point);
    ////设置服务请求成功的回调函数
    //geocoder.setComplete(function (result) {
    //    alert("地址为： " + result.detail.address);
    //});
    ////若服务请求失败，则运行以下函数
    //geocoder.setError(function () {
    //    alert("出错了，请输入正确的地址！！！");
    //});
